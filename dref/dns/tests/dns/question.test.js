import DNSQuestion from '../../src/dns/question'

test('parses DNS A record', () => {
  const bufferARecord = Buffer.from([
    0xb9, 0x36, 0x84, 0x00, 0x00, 0x01, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00,
    0x06, 0x72, 0x61, 0x6e, 0x64, 0x6f, 0x6d, 0x02, 0x63, 0x6f, 0x02, 0x75,
    0x6b, 0x00, 0x00, 0x01, 0x00, 0x01, 0xc0, 0x0c, 0x00, 0x01, 0x00, 0x01,
    0x00, 0x00, 0x00, 0x01, 0x00, 0x04, 0xc0, 0xa8, 0x01, 0x01])

  const question = new DNSQuestion(bufferARecord)

  expect(question.id).toEqual(0xb936)
  expect(question.qname).toEqual('random.co.uk')
  expect(question.qtype).toEqual(1)
})

test('parses DNS NS record', () => {
  const bufferNSRecord = Buffer.from([
    0x33, 0xc9, 0x01, 0x20, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,
    0x06, 0x72, 0x61, 0x6e, 0x64, 0x6f, 0x6d, 0x02, 0x63, 0x6f, 0x02, 0x75,
    0x6b, 0x00, 0x00, 0x02, 0x00, 0x01, 0x00, 0x00, 0x29, 0x10, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00])

  const question = new DNSQuestion(bufferNSRecord)

  expect(question.id).toEqual(0x33c9)
  expect(question.qname).toEqual('random.co.uk')
  expect(question.qtype).toEqual(2)
})
